## API Report File for "zql-viz"

> Do not edit this file. It is a report generated by [API Extractor](https://api-extractor.com/).

```ts

import type { LogLevel } from '@rocicorp/logger';
import type { LogSink } from '@rocicorp/logger';
import * as v_2 from '@badrap/valita';

// @public (undocumented)
export const ANYONE_CAN: ((_: unknown, eb: ExpressionBuilder<Schema, never>) => Condition)[];

// @public (undocumented)
export const ANYONE_CAN_DO_ANYTHING: {
    row: {
        select: ((_: unknown, eb: ExpressionBuilder<Schema, never>) => Condition)[];
        insert: ((_: unknown, eb: ExpressionBuilder<Schema, never>) => Condition)[];
        update: {
            preMutation: ((_: unknown, eb: ExpressionBuilder<Schema, never>) => Condition)[];
            postMutation: ((_: unknown, eb: ExpressionBuilder<Schema, never>) => Condition)[];
        };
        delete: ((_: unknown, eb: ExpressionBuilder<Schema, never>) => Condition)[];
    };
};

// @public (undocumented)
export type AnyQuery = Query<Schema, string, any>;

// Warning: (ae-forgotten-export) The symbol "SourceSchema" needs to be exported by the entry point mod.d.ts
//
// @public (undocumented)
export function applyChange(parentEntry: Entry, change: ViewChange, schema: SourceSchema, relationship: string, format: Format, withIDs?: boolean): void;

// @public (undocumented)
export type AssetPermissions<TAuthDataShape, TSchema extends Schema, TTable extends keyof TSchema['tables'] & string> = {
    select?: PermissionRule<TAuthDataShape, TSchema, TTable>[] | undefined;
    insert?: PermissionRule<TAuthDataShape, TSchema, TTable>[] | undefined;
    update?: {
        preMutation?: PermissionRule<TAuthDataShape, TSchema, TTable>[];
        postMutation?: PermissionRule<TAuthDataShape, TSchema, TTable>[];
    } | undefined;
    delete?: PermissionRule<TAuthDataShape, TSchema, TTable>[] | undefined;
};

// @public (undocumented)
export type AST = {
    readonly schema?: string | undefined;
    readonly table: string;
    readonly alias?: string | undefined;
    readonly where?: Condition | undefined;
    readonly related?: readonly CorrelatedSubquery[] | undefined;
    readonly start?: Bound | undefined;
    readonly limit?: number | undefined;
    readonly orderBy?: Ordering | undefined;
};

// @public (undocumented)
const AuthInvalidated = "AuthInvalidated";

// @public (undocumented)
type AuthInvalidated = typeof AuthInvalidated;

// @public (undocumented)
export type BatchMutator<S extends Schema> = <R>(body: (m: DBMutator<S>) => MaybePromise<R>) => Promise<R>;

// @public (undocumented)
export function boolean<T extends boolean = boolean>(): ColumnBuilder<{
    type: "boolean";
    optional: false;
    customType: T;
}>;

// @public (undocumented)
export type Bound = {
    row: Row_2;
    exclusive: boolean;
};

// Warning: (ae-forgotten-export) The symbol "AddChange" needs to be exported by the entry point mod.d.ts
// Warning: (ae-forgotten-export) The symbol "RemoveChange" needs to be exported by the entry point mod.d.ts
// Warning: (ae-forgotten-export) The symbol "ChildChange" needs to be exported by the entry point mod.d.ts
// Warning: (ae-forgotten-export) The symbol "EditChange" needs to be exported by the entry point mod.d.ts
//
// @public (undocumented)
export type Change = AddChange | RemoveChange | ChildChange | EditChange;

// @public
export type ClientGroupID = string;

// @public
export type ClientID = string;

// @public (undocumented)
const ClientNotFound = "ClientNotFound";

// @public (undocumented)
type ClientNotFound = typeof ClientNotFound;

// @public (undocumented)
export class ColumnBuilder<TShape extends SchemaValue<any>> {
    constructor(schema: TShape);
    // (undocumented)
    from<ServerName extends string>(serverName: ServerName): ColumnBuilder<TShape & {
        serverName: string;
    }>;
    // (undocumented)
    optional(): ColumnBuilder<Omit<TShape, 'optional'> & {
        optional: true;
    }>;
    // (undocumented)
    get schema(): TShape;
}

// @public (undocumented)
export type ColumnReference = {
    readonly type: 'column';
    readonly name: string;
};

// Warning: (ae-forgotten-export) The symbol "v" needs to be exported by the entry point mod.d.ts
// Warning: (ae-forgotten-export) The symbol "assetSchema" needs to be exported by the entry point mod.d.ts
//
// @public (undocumented)
export type CompiledAssetPermissions = v.Infer<typeof assetSchema>;

// Warning: (ae-forgotten-export) The symbol "permissionsConfigSchema" needs to be exported by the entry point mod.d.ts
//
// @public (undocumented)
export type CompiledPermissionsConfig = v.Infer<typeof permissionsConfigSchema>;

// Warning: (ae-forgotten-export) The symbol "policySchema" needs to be exported by the entry point mod.d.ts
//
// @public (undocumented)
export type CompiledPermissionsPolicy = v.Infer<typeof policySchema>;

// Warning: (ae-forgotten-export) The symbol "ruleSchema" needs to be exported by the entry point mod.d.ts
//
// @public (undocumented)
export type CompiledPermissionsRule = v.Infer<typeof ruleSchema>;

// @public (undocumented)
export type CompoundKey = readonly [string, ...string[]];

// @public
export type Condition = SimpleCondition | Conjunction | Disjunction | CorrelatedSubqueryCondition;

// @public (undocumented)
export type Conjunction = {
    type: 'and';
    conditions: readonly Condition[];
};

// @public (undocumented)
export type CorrelatedSubquery = {
    readonly correlation: Correlation;
    readonly subquery: AST;
    readonly system?: System | undefined;
    readonly hidden?: boolean | undefined;
};

// @public (undocumented)
export type CorrelatedSubqueryCondition = {
    type: 'correlatedSubquery';
    related: CorrelatedSubquery;
    op: CorrelatedSubqueryConditionOperator;
};

// @public (undocumented)
export type CorrelatedSubqueryConditionOperator = 'EXISTS' | 'NOT EXISTS';

// @public
export function createBuilder<S extends Schema>(s: S): SchemaQuery<S>;

// @public
export type CreateKVStore = (name: string) => KVStore;

// Warning: (ae-forgotten-export) The symbol "Relationships" needs to be exported by the entry point mod.d.ts
//
// @public
export function createSchema<const TTables extends readonly TableBuilderWithColumns<TableSchema>[], const TRelationships extends readonly Relationships[]>(options: {
    readonly tables: TTables;
    readonly relationships?: TRelationships | undefined;
}): {
    tables: {
        readonly [K in TTables[number]['schema']['name']]: Extract<TTables[number]['schema'], {
            name: K;
        }>;
    };
    relationships: {
        readonly [K in TRelationships[number]['name']]: Extract<TRelationships[number], {
            name: K;
        }>['relationships'];
    };
};

// @public
export type CustomMutatorDefs = {
    [namespaceOrKey: string]: {
        [key: string]: CustomMutatorImpl<any>;
    } | CustomMutatorImpl<any>;
};

// @public (undocumented)
export type CustomMutatorImpl<S extends Schema, TWrappedTransaction = unknown, TArgs = any> = (tx: Transaction<S, TWrappedTransaction>, args: TArgs) => Promise<void>;

// @public (undocumented)
export type CustomQueryID = {
    name: string;
    args: ReadonlyArray<ReadonlyJSONValue>;
};

// @public (undocumented)
export type DBMutator<S extends Schema> = {
    [K in keyof S['tables']]: TableMutator<S['tables'][K]>;
};

// @public (undocumented)
export function definePermissions<TAuthDataShape, TSchema extends Schema>(schema: TSchema, definer: () => Promise<PermissionsConfig<TAuthDataShape, TSchema>> | PermissionsConfig<TAuthDataShape, TSchema>): Promise<CompiledPermissionsConfig | undefined>;

// Warning: (ae-forgotten-export) The symbol "Expand" needs to be exported by the entry point mod.d.ts
// Warning: (ae-forgotten-export) The symbol "PrimaryKeyFields" needs to be exported by the entry point mod.d.ts
//
// @public (undocumented)
export type DeleteID<S extends TableSchema> = Expand<PrimaryKeyFields<S>>;

// @public (undocumented)
export type Disjunction = {
    type: 'or';
    conditions: readonly Condition[];
};

// Warning: (ae-forgotten-export) The symbol "DropDatabaseOptions" needs to be exported by the entry point mod.d.ts
//
// @public
export function dropAllDatabases(opts?: DropDatabaseOptions | undefined): Promise<{
    dropped: string[];
    errors: unknown[];
}>;

// @public
export function dropDatabase(dbName: string, opts?: DropDatabaseOptions | undefined): Promise<void>;

// @public (undocumented)
export type Entry = {
    readonly [key: string]: Value | View;
};

// @public (undocumented)
export function enumeration<T extends string>(): ColumnBuilder<{
    type: "string";
    optional: false;
    customType: T;
}>;

// @public (undocumented)
export type EnumSchemaValue<T> = {
    kind: 'enum';
    type: 'string';
    serverName?: string | undefined;
    optional?: boolean;
    customType: T;
};

// @public (undocumented)
export type EqualityOps = '=' | '!=' | 'IS' | 'IS NOT';

declare namespace ErrorKind {
    export {
        AuthInvalidated,
        ClientNotFound,
        InvalidConnectionRequest,
        InvalidConnectionRequestBaseCookie,
        InvalidConnectionRequestLastMutationID,
        InvalidConnectionRequestClientDeleted,
        InvalidMessage,
        InvalidPush,
        MutationFailed,
        MutationRateLimited,
        Rebalance,
        Rehome,
        Unauthorized,
        VersionNotSupported,
        SchemaVersionNotSupported,
        ServerOverloaded,
        Internal
    }
}
export { ErrorKind }

// @public (undocumented)
export function escapeLike(val: string): string;

// @public (undocumented)
export class ExpressionBuilder<TSchema extends Schema, TTable extends keyof TSchema['tables'] & string> {
    constructor(exists: (relationship: string, cb?: (query: Query<TSchema, TTable>) => Query<TSchema, any>) => Condition);
    // Warning: (ae-forgotten-export) The symbol "and" needs to be exported by the entry point mod.d.ts
    //
    // (undocumented)
    and: typeof and;
    // Warning: (ae-forgotten-export) The symbol "NoCompoundTypeSelector" needs to be exported by the entry point mod.d.ts
    // Warning: (ae-forgotten-export) The symbol "PullTableSchema" needs to be exported by the entry point mod.d.ts
    // Warning: (ae-forgotten-export) The symbol "GetFilterType" needs to be exported by the entry point mod.d.ts
    // Warning: (ae-forgotten-export) The symbol "ParameterReference" needs to be exported by the entry point mod.d.ts
    //
    // (undocumented)
    cmp<TSelector extends NoCompoundTypeSelector<PullTableSchema<TTable, TSchema>>, TOperator extends SimpleOperator>(field: TSelector, op: TOperator, value: GetFilterType<PullTableSchema<TTable, TSchema>, TSelector, TOperator> | ParameterReference): Condition;
    // (undocumented)
    cmp<TSelector extends NoCompoundTypeSelector<PullTableSchema<TTable, TSchema>>>(field: TSelector, value: GetFilterType<PullTableSchema<TTable, TSchema>, TSelector, '='> | ParameterReference): Condition;
    // (undocumented)
    cmpLit(left: ParameterReference | LiteralValue, op: SimpleOperator, right: ParameterReference | LiteralValue): Condition;
    // (undocumented)
    get eb(): this;
    // Warning: (ae-forgotten-export) The symbol "AvailableRelationships" needs to be exported by the entry point mod.d.ts
    // Warning: (ae-forgotten-export) The symbol "DestTableName" needs to be exported by the entry point mod.d.ts
    //
    // (undocumented)
    exists: <TRelationship extends AvailableRelationships<TTable, TSchema>>(relationship: TRelationship, cb?: (query: Query<TSchema, DestTableName<TTable, TSchema, TRelationship>>) => Query<TSchema, any>) => Condition;
    // Warning: (ae-forgotten-export) The symbol "not" needs to be exported by the entry point mod.d.ts
    //
    // (undocumented)
    not: typeof not;
    // Warning: (ae-forgotten-export) The symbol "or" needs to be exported by the entry point mod.d.ts
    //
    // (undocumented)
    or: typeof or;
}

// @public
export interface ExpressionFactory<TSchema extends Schema, TTable extends keyof TSchema['tables'] & string> {
    // (undocumented)
    (eb: ExpressionBuilder<TSchema, TTable>): Condition;
}

// @public (undocumented)
export type Format = {
    singular: boolean;
    relationships: Record<string, Format>;
};

// Warning: (ae-forgotten-export) The symbol "Puller" needs to be exported by the entry point mod.d.ts
//
// @public
export function getDefaultPuller(rep: {
    pullURL: string;
    auth: string;
}): Puller;

// @public (undocumented)
export type HTTPRequestInfo = {
    httpStatusCode: number;
    errorMessage: string;
};

// @public
export type HumanReadable<T> = undefined extends T ? Expand<T> : Expand<T>[];

// @public
export class IDBNotFoundError extends Error {
    // (undocumented)
    name: string;
}

// @public (undocumented)
export type InOps = 'IN' | 'NOT IN';

// Warning: (ae-forgotten-export) The symbol "InputBase" needs to be exported by the entry point mod.d.ts
//
// @public (undocumented)
export interface Input extends InputBase {
    cleanup(req: FetchRequest): Stream<Node_2>;
    // Warning: (ae-forgotten-export) The symbol "FetchRequest" needs to be exported by the entry point mod.d.ts
    fetch(req: FetchRequest): Stream<Node_2>;
    setOutput(output: Output): void;
}

// Warning: (ae-forgotten-export) The symbol "SchemaValueToTSType" needs to be exported by the entry point mod.d.ts
//
// @public (undocumented)
export type InsertValue<S extends TableSchema> = Expand<PrimaryKeyFields<S> & {
    [K in keyof S['columns'] as S['columns'][K] extends {
        optional: true;
    } ? K : never]?: SchemaValueToTSType<S['columns'][K]> | undefined;
} & {
    [K in keyof S['columns'] as S['columns'][K] extends {
        optional: true;
    } ? never : K]: SchemaValueToTSType<S['columns'][K]>;
}>;

// @public (undocumented)
export interface Inspector {
    // (undocumented)
    readonly client: InspectorClient;
    // (undocumented)
    readonly clientGroup: InspectorClientGroup;
    // (undocumented)
    clients(): Promise<InspectorClient[]>;
    // (undocumented)
    clientsWithQueries(): Promise<InspectorClient[]>;
}

// @public (undocumented)
export interface InspectorClient {
    // (undocumented)
    readonly clientGroup: InspectorClientGroup;
    // (undocumented)
    readonly id: string;
    // (undocumented)
    map(): Promise<Map<string, ReadonlyJSONValue>>;
    // (undocumented)
    queries(): Promise<InspectorQuery[]>;
    // (undocumented)
    rows(tableName: string): Promise<Row_2[]>;
}

// @public (undocumented)
export interface InspectorClientGroup {
    // (undocumented)
    clients(): Promise<InspectorClient[]>;
    // (undocumented)
    clientsWithQueries(): Promise<InspectorClient[]>;
    // (undocumented)
    readonly id: string;
    // (undocumented)
    queries(): Promise<InspectorQuery[]>;
}

// @public (undocumented)
export interface InspectorQuery {
    // (undocumented)
    readonly args: ReadonlyArray<ReadonlyJSONValue> | null;
    // (undocumented)
    readonly ast: AST | null;
    // (undocumented)
    readonly clientID: string;
    // (undocumented)
    readonly deleted: boolean;
    // (undocumented)
    readonly got: boolean;
    // (undocumented)
    readonly id: string;
    // (undocumented)
    readonly inactivatedAt: Date | null;
    // (undocumented)
    readonly name: string | null;
    // (undocumented)
    readonly rowCount: number;
    // (undocumented)
    readonly ttl: TTL;
    // (undocumented)
    readonly zql: string | null;
}

// @public (undocumented)
const Internal = "Internal";

// @public (undocumented)
type Internal = typeof Internal;

// @public (undocumented)
const InvalidConnectionRequest = "InvalidConnectionRequest";

// @public (undocumented)
type InvalidConnectionRequest = typeof InvalidConnectionRequest;

// @public (undocumented)
const InvalidConnectionRequestBaseCookie = "InvalidConnectionRequestBaseCookie";

// @public (undocumented)
type InvalidConnectionRequestBaseCookie = typeof InvalidConnectionRequestBaseCookie;

// @public (undocumented)
const InvalidConnectionRequestClientDeleted = "InvalidConnectionRequestClientDeleted";

// @public (undocumented)
type InvalidConnectionRequestClientDeleted = typeof InvalidConnectionRequestClientDeleted;

// @public (undocumented)
const InvalidConnectionRequestLastMutationID = "InvalidConnectionRequestLastMutationID";

// @public (undocumented)
type InvalidConnectionRequestLastMutationID = typeof InvalidConnectionRequestLastMutationID;

// @public (undocumented)
const InvalidMessage = "InvalidMessage";

// @public (undocumented)
type InvalidMessage = typeof InvalidMessage;

// @public (undocumented)
const InvalidPush = "InvalidPush";

// @public (undocumented)
type InvalidPush = typeof InvalidPush;

// @public (undocumented)
export function json<T extends ReadonlyJSONValue = ReadonlyJSONValue>(): ColumnBuilder<{
    type: "json";
    optional: false;
    customType: T;
}>;

// @public
export type JSONObject = {
    [key: string]: JSONValue | undefined;
};

// @public
export type JSONValue = null | string | boolean | number | Array<JSONValue> | JSONObject;

// Warning: (ae-forgotten-export) The symbol "Release" needs to be exported by the entry point mod.d.ts
//
// @public
export interface KVRead extends Release {
    // (undocumented)
    closed: boolean;
    // (undocumented)
    get(key: string): Promise<ReadonlyJSONValue | undefined>;
    // (undocumented)
    has(key: string): Promise<boolean>;
}

// @public
export interface KVStore {
    // (undocumented)
    close(): Promise<void>;
    // (undocumented)
    closed: boolean;
    // (undocumented)
    read(): Promise<KVRead>;
    // (undocumented)
    write(): Promise<KVWrite>;
}

// @public
export interface KVWrite extends KVRead {
    // (undocumented)
    commit(): Promise<void>;
    // (undocumented)
    del(key: string): Promise<void>;
    // (undocumented)
    put(key: string, value: ReadonlyJSONValue): Promise<void>;
}

// @public (undocumented)
export type LikeOps = 'LIKE' | 'NOT LIKE' | 'ILIKE' | 'NOT ILIKE';

// @public (undocumented)
export type LiteralReference = {
    readonly type: 'literal';
    readonly value: LiteralValue;
};

// @public (undocumented)
export type LiteralValue = string | number | boolean | null | ReadonlyArray<string | number | boolean>;

// Warning: (ae-forgotten-export) The symbol "ClientTransaction" needs to be exported by the entry point mod.d.ts
//
// @public (undocumented)
export type MakeCustomMutatorInterface<S extends Schema, F> = F extends (tx: ClientTransaction<S>, ...args: infer Args) => Promise<void> ? (...args: Args) => PromiseWithServerResult : never;

// @public
export type MakeCustomMutatorInterfaces<S extends Schema, MD extends CustomMutatorDefs> = {
    readonly [NamespaceOrName in keyof MD]: MD[NamespaceOrName] extends (tx: Transaction<S>, ...args: infer Args) => Promise<void> ? (...args: Args) => PromiseWithServerResult : {
        readonly [P in keyof MD[NamespaceOrName]]: MakeCustomMutatorInterface<S, MD[NamespaceOrName][P]>;
    };
};

// @public (undocumented)
export type MakeEntityQueriesFromSchema<S extends Schema> = {
    readonly [K in keyof S['tables'] & string]: Query<S, K>;
};

// @public
export function makeIDBName(name: string, schemaVersion?: string): string;

// @public (undocumented)
export type MaybePromise<T> = T | Promise<T>;

// @public (undocumented)
const MutationFailed = "MutationFailed";

// @public (undocumented)
type MutationFailed = typeof MutationFailed;

// @public (undocumented)
const MutationRateLimited = "MutationRateLimited";

// @public (undocumented)
type MutationRateLimited = typeof MutationRateLimited;

// @public (undocumented)
export type NamedQuery<TArg extends ReadonlyArray<ReadonlyJSONValue> = ReadonlyArray<ReadonlyJSONValue>, TReturnQuery extends Query<any, any, any> = Query<any, any, any>> = (...args: TArg) => TReturnQuery;

// @public
const NewClientGroup = "NewClientGroup";

// @public (undocumented)
type NewClientGroup = typeof NewClientGroup;

// @public (undocumented)
export const NOBODY_CAN: never[];

// @public
type Node_2 = {
    row: Row_2;
    relationships: Record<string, () => Stream<Node_2>>;
};
export { Node_2 as Node }

// @public (undocumented)
export function number<T extends number = number>(): ColumnBuilder<{
    type: "number";
    optional: false;
    customType: T;
}>;

// @public
export type OnError = (message: string, ...rest: unknown[]) => void;

// @public
export type OnErrorParameters = Parameters<OnError>;

// @public (undocumented)
export type Ordering = readonly OrderPart[];

// @public (undocumented)
export type OrderOps = '<' | '>' | '<=' | '>=';

// @public
export type OrderPart = readonly [field: string, direction: 'asc' | 'desc'];

// @public
export interface Output {
    push(change: Change): void;
}

// Warning: (ae-forgotten-export) The symbol "parameterReferenceSchema" needs to be exported by the entry point mod.d.ts
//
// @public (undocumented)
export type Parameter = v.Infer<typeof parameterReferenceSchema>;

// @public (undocumented)
export type PermissionRule<TAuthDataShape, TSchema extends Schema, TTable extends keyof TSchema['tables'] & string> = (authData: TAuthDataShape, eb: ExpressionBuilder<TSchema, TTable>) => Condition;

// @public (undocumented)
export type PermissionsConfig<TAuthDataShape, TSchema extends Schema> = {
    [K in keyof TSchema['tables']]?: {
        row?: AssetPermissions<TAuthDataShape, TSchema, K & string> | undefined;
        cell?: {
            [C in keyof TSchema['tables'][K]['columns']]?: Omit<AssetPermissions<TAuthDataShape, TSchema, K & string>, 'cell'>;
        } | undefined;
    };
};

// @public (undocumented)
export type PromiseWithServerResult = {
    client: Promise<void>;
    server: Promise<MutationOk>;
};

// @public (undocumented)
export type PullRow<TTable extends string, TSchema extends Schema> = {
    readonly [K in keyof PullTableSchema<TTable, TSchema>['columns']]: SchemaValueToTSType<PullTableSchema<TTable, TSchema>['columns'][K]>;
};

// @public (undocumented)
export function queries<TQueries extends {
    [K in keyof TQueries]: TQueries[K] extends NamedQuery<infer TArgs, Query<any, any, any>> ? TArgs extends ReadonlyArray<ReadonlyJSONValue> ? NamedQuery<TArgs, Query<any, any, any>> : never : never;
}>(queries: TQueries): TQueries;

// Warning: (ae-forgotten-export) The symbol "ContextualizedNamedQuery" needs to be exported by the entry point mod.d.ts
//
// @public (undocumented)
export function queriesWithContext<TContext, TQueries extends {
    [K in keyof TQueries]: TQueries[K] extends ContextualizedNamedQuery<TContext, infer TArgs, Query<any, any, any>> ? TArgs extends ReadonlyArray<ReadonlyJSONValue> ? ContextualizedNamedQuery<TContext, TArgs, Query<any, any, any>> : never : never;
}>(queries: TQueries): TQueries;

// @public
export interface Query<TSchema extends Schema, TTable extends keyof TSchema['tables'] & string, TReturn = PullRow<TTable, TSchema>> extends PromiseLike<HumanReadable<TReturn>> {
    // (undocumented)
    readonly ast: AST;
    // (undocumented)
    readonly customQueryID: CustomQueryID | undefined;
    // Warning: (ae-forgotten-export) The symbol "QueryDelegate" needs to be exported by the entry point mod.d.ts
    //
    // (undocumented)
    delegate(delegate: QueryDelegate): Query<TSchema, TTable, TReturn>;
    readonly format: Format;
    hash(): string;
    limit(limit: number): Query<TSchema, TTable, TReturn>;
    materialize(ttl?: TTL): TypedView<HumanReadable<TReturn>>;
    materialize<T>(factory: ViewFactory<TSchema, TTable, TReturn, T>, ttl?: TTL): T;
    // (undocumented)
    nameAndArgs(name: string, args: ReadonlyArray<ReadonlyJSONValue>): Query<TSchema, TTable, TReturn>;
    one(): Query<TSchema, TTable, TReturn | undefined>;
    // Warning: (ae-forgotten-export) The symbol "Selector" needs to be exported by the entry point mod.d.ts
    orderBy<TSelector extends Selector<PullTableSchema<TTable, TSchema>>>(field: TSelector, direction: 'asc' | 'desc'): Query<TSchema, TTable, TReturn>;
    // Warning: (ae-forgotten-export) The symbol "PreloadOptions" needs to be exported by the entry point mod.d.ts
    preload(options?: PreloadOptions): {
        cleanup: () => void;
        complete: Promise<void>;
    };
    // Warning: (ae-forgotten-export) The symbol "AddSubreturn" needs to be exported by the entry point mod.d.ts
    // Warning: (ae-forgotten-export) The symbol "DestRow" needs to be exported by the entry point mod.d.ts
    related<TRelationship extends AvailableRelationships<TTable, TSchema>>(relationship: TRelationship): Query<TSchema, TTable, AddSubreturn<TReturn, DestRow<TTable, TSchema, TRelationship>, TRelationship>>;
    // (undocumented)
    related<TRelationship extends AvailableRelationships<TTable, TSchema>, TSub extends Query<TSchema, string, any>>(relationship: TRelationship, cb: (q: Query<TSchema, DestTableName<TTable, TSchema, TRelationship>, DestRow<TTable, TSchema, TRelationship>>) => TSub): Query<TSchema, TTable, AddSubreturn<TReturn, TSub extends Query<TSchema, string, infer TSubReturn> ? TSubReturn : never, TRelationship>>;
    run(options?: RunOptions): Promise<HumanReadable<TReturn>>;
    start(row: Partial<PullRow<TTable, TSchema>>, opts?: {
        inclusive: boolean;
    } | undefined): Query<TSchema, TTable, TReturn>;
    where<TSelector extends NoCompoundTypeSelector<PullTableSchema<TTable, TSchema>>, TOperator extends SimpleOperator>(field: TSelector, op: TOperator, value: GetFilterType<PullTableSchema<TTable, TSchema>, TSelector, TOperator> | ParameterReference): Query<TSchema, TTable, TReturn>;
    where<TSelector extends NoCompoundTypeSelector<PullTableSchema<TTable, TSchema>>>(field: TSelector, value: GetFilterType<PullTableSchema<TTable, TSchema>, TSelector, '='> | ParameterReference): Query<TSchema, TTable, TReturn>;
    where(expressionFactory: ExpressionFactory<TSchema, TTable>): Query<TSchema, TTable, TReturn>;
    // (undocumented)
    whereExists(relationship: AvailableRelationships<TTable, TSchema>): Query<TSchema, TTable, TReturn>;
    // (undocumented)
    whereExists<TRelationship extends AvailableRelationships<TTable, TSchema>>(relationship: TRelationship, cb: (q: Query<TSchema, DestTableName<TTable, TSchema, TRelationship>>) => Query<TSchema, string>): Query<TSchema, TTable, TReturn>;
}

// @public
export type ReadonlyJSONObject = {
    readonly [key: string]: ReadonlyJSONValue | undefined;
};

// @public
export type ReadonlyJSONValue = null | string | boolean | number | ReadonlyArray<ReadonlyJSONValue> | ReadonlyJSONObject;

// @public (undocumented)
const Rebalance = "Rebalance";

// @public (undocumented)
type Rebalance = typeof Rebalance;

// @public (undocumented)
const Rehome = "Rehome";

// @public (undocumented)
type Rehome = typeof Rehome;

// Warning: (ae-forgotten-export) The symbol "Relationship" needs to be exported by the entry point mod.d.ts
//
// @public (undocumented)
export function relationships<TSource extends TableSchema, TRelationships extends Record<string, Relationship>>(table: TableBuilderWithColumns<TSource>, cb: (connects: {
    many: <TDests extends TableSchema[], TSourceFields extends {
        [K in keyof TDests]: (keyof PreviousSchema<TSource, K & number, TDests>['columns'] & string)[];
    }, TDestFields extends {
        [K in keyof TDests]: (keyof TDests[K]['columns'] & string)[];
    }>(...args: {
        [K in keyof TDests]: ConnectArg<TSourceFields[K], TDestFields[K], TDests[K]>;
    }) => {
        [K in keyof TDests]: ManyConnection<TSourceFields[K], TDestFields[K], TDests[K]>;
    };
    one: <TDests extends TableSchema[], TSourceFields extends {
        [K in keyof TDests]: (keyof PreviousSchema<TSource, K & number, TDests>['columns'] & string)[];
    }, TDestFields extends {
        [K in keyof TDests]: (keyof TDests[K]['columns'] & string)[];
    }>(...args: {
        [K in keyof TDests]: ConnectArg<TSourceFields[K], TDestFields[K], TDests[K]>;
    }) => {
        [K in keyof TDests]: OneConnection<TSourceFields[K], TDestFields[K], TDests[K]>;
    };
}) => TRelationships): {
    name: TSource['name'];
    relationships: TRelationships;
};

// @public (undocumented)
export type ResultType = 'unknown' | 'complete';

// @public (undocumented)
export type Row<T extends TableSchema | Query<Schema, string, any>> = T extends TableSchema ? {
    readonly [K in keyof T['columns']]: SchemaValueToTSType<T['columns'][K]>;
} : T extends Query<Schema, string, infer TReturn> ? TReturn : never;

// @public
export type RunOptions = {
    type: 'unknown' | 'complete';
    ttl?: TTL;
};

// @public (undocumented)
export type Schema = {
    readonly tables: {
        readonly [table: string]: TableSchema;
    };
    readonly relationships: {
        readonly [table: string]: RelationshipsSchema;
    };
};

// @public (undocumented)
export type SchemaQuery<S extends Schema> = {
    readonly [K in keyof S['tables'] & string]: Query<S, K>;
};

// @public
export type SchemaValue<T = unknown> = {
    type: ValueType;
    serverName?: string | undefined;
    optional?: boolean | undefined;
} | EnumSchemaValue<T> | SchemaValueWithCustomType<T>;

// @public (undocumented)
export type SchemaValueWithCustomType<T> = {
    type: ValueType;
    serverName?: string | undefined;
    optional?: boolean;
    customType: T;
};

// @public (undocumented)
const SchemaVersionNotSupported = "SchemaVersionNotSupported";

// @public (undocumented)
type SchemaVersionNotSupported = typeof SchemaVersionNotSupported;

// @public
const SchemaVersionNotSupported_2 = "SchemaVersionNotSupported";

// @public (undocumented)
type SchemaVersionNotSupported_2 = typeof SchemaVersionNotSupported_2;

// @public (undocumented)
const ServerOverloaded = "ServerOverloaded";

// @public (undocumented)
type ServerOverloaded = typeof ServerOverloaded;

// Warning: (ae-forgotten-export) The symbol "TransactionBase" needs to be exported by the entry point mod.d.ts
//
// @public (undocumented)
export interface ServerTransaction<S extends Schema, TWrappedTransaction> extends TransactionBase<S> {
    // Warning: (ae-forgotten-export) The symbol "DBTransaction" needs to be exported by the entry point mod.d.ts
    //
    // (undocumented)
    readonly dbTransaction: DBTransaction<TWrappedTransaction>;
    // (undocumented)
    readonly location: 'server';
    // (undocumented)
    readonly reason: 'authoritative';
}

// @public (undocumented)
export type SimpleCondition = {
    readonly type: 'simple';
    readonly op: SimpleOperator;
    readonly left: ValuePosition;
    readonly right: Exclude<ValuePosition, ColumnReference>;
};

// @public (undocumented)
export type SimpleOperator = EqualityOps | OrderOps | LikeOps | InOps;

// @public
export type Stream<T> = Iterable<T>;

// @public (undocumented)
export function string<T extends string = string>(): ColumnBuilder<{
    type: "string";
    optional: false;
    customType: T;
}>;

// Warning: (ae-forgotten-export) The symbol "TableBuilder" needs to be exported by the entry point mod.d.ts
//
// @public (undocumented)
export function table<TName extends string>(name: TName): TableBuilder<{
    name: TName;
    columns: {};
    primaryKey: PrimaryKey;
}>;

// @public (undocumented)
export class TableBuilderWithColumns<TShape extends TableSchema> {
    constructor(schema: TShape);
    // (undocumented)
    build(): TShape;
    // (undocumented)
    primaryKey<TPKColNames extends (keyof TShape['columns'])[]>(...pkColumnNames: TPKColNames): TableBuilderWithColumns<TShape & {
        primaryKey: TPKColNames;
    }>;
    // (undocumented)
    get schema(): TShape;
}

// @public
export type TableMutator<S extends TableSchema> = {
    insert: (value: InsertValue<S>) => Promise<void>;
    upsert: (value: UpsertValue<S>) => Promise<void>;
    update: (value: UpdateValue<S>) => Promise<void>;
    delete: (id: DeleteID<S>) => Promise<void>;
};

// @public (undocumented)
export type TableSchema = {
    readonly name: string;
    readonly serverName?: string | undefined;
    readonly columns: Record<string, SchemaValue>;
    readonly primaryKey: PrimaryKey;
};

// @public (undocumented)
export type Transaction<S extends Schema, TWrappedTransaction = unknown> = ServerTransaction<S, TWrappedTransaction> | ClientTransaction<S>;

// @public
export class TransactionClosedError extends Error {
    constructor();
}

// Warning: (ae-forgotten-export) The symbol "transformRequestBodySchema" needs to be exported by the entry point mod.d.ts
//
// @public (undocumented)
export type TransformRequestBody = v.Infer<typeof transformRequestBodySchema>;

// @public (undocumented)
export type TransformRequestMessage = v.Infer<typeof transformRequestMessageSchema>;

// @public (undocumented)
export const transformRequestMessageSchema: v.TupleType<[v.Type<"transform">, v.ArrayType<v.ObjectType<{
    id: v.Type<string>;
    name: v.Type<string>;
    args: v.Type<readonly ReadonlyJSONValue[]>;
}, undefined>>]>;

// Warning: (ae-forgotten-export) The symbol "transformResponseBodySchema" needs to be exported by the entry point mod.d.ts
//
// @public (undocumented)
export type TransformResponseBody = v.Infer<typeof transformResponseBodySchema>;

// @public (undocumented)
export type TransformResponseMessage = v.Infer<typeof transformResponseMessageSchema>;

// @public (undocumented)
export const transformResponseMessageSchema: v.TupleType<[v.Type<"transformed">, v.ArrayType<v.UnionType<[v.ObjectType<{
    id: v.Type<string>;
    name: v.Type<string>;
    ast: v.Type<AST>;
}, undefined>, v.ObjectType<{
    error: v.Type<"app">;
    id: v.Type<string>;
    name: v.Type<string>;
    details: v.Type<ReadonlyJSONValue>;
}, undefined>]>>]>;

// Warning: (ae-forgotten-export) The symbol "TimeUnit" needs to be exported by the entry point mod.d.ts
//
// @public
export type TTL = `${number}${TimeUnit}` | 'forever' | 'none' | number;

// @public (undocumented)
export type TypedView<T> = {
    addListener(listener: Listener<T>): () => void;
    destroy(): void;
    updateTTL(ttl: TTL): void;
    readonly data: T;
};

// @public (undocumented)
const Unauthorized = "Unauthorized";

// @public (undocumented)
type Unauthorized = typeof Unauthorized;

// @public (undocumented)
export type UpdateNeededReason = {
    type: UpdateNeededReasonType.NewClientGroup;
} | {
    type: UpdateNeededReasonType.VersionNotSupported;
} | {
    type: UpdateNeededReasonType.SchemaVersionNotSupported;
};

declare namespace UpdateNeededReasonType {
    export {
        NewClientGroup,
        VersionNotSupported_2 as VersionNotSupported,
        SchemaVersionNotSupported_2 as SchemaVersionNotSupported
    }
}
export { UpdateNeededReasonType }

// @public (undocumented)
export type UpdateValue<S extends TableSchema> = Expand<PrimaryKeyFields<S> & {
    [K in keyof S['columns']]?: SchemaValueToTSType<S['columns'][K]> | undefined;
}>;

// @public (undocumented)
export type UpsertValue<S extends TableSchema> = InsertValue<S>;

// @public (undocumented)
export type ValuePosition = LiteralReference | Parameter | ColumnReference;

// @public (undocumented)
export type ValueType = 'string' | 'number' | 'boolean' | 'null' | 'json';

// @public (undocumented)
const VersionNotSupported = "VersionNotSupported";

// @public (undocumented)
type VersionNotSupported = typeof VersionNotSupported;

// @public
const VersionNotSupported_2 = "VersionNotSupported";

// @public (undocumented)
type VersionNotSupported_2 = typeof VersionNotSupported_2;

// @public
export type VersionNotSupportedResponse = {
    error: 'VersionNotSupported';
    versionType?: 'pull' | 'push' | 'schema' | undefined;
};

// Warning: (ae-forgotten-export) The symbol "EntryList" needs to be exported by the entry point mod.d.ts
//
// @public (undocumented)
export type View = EntryList | Entry | undefined;

// Warning: (ae-forgotten-export) The symbol "AddViewChange" needs to be exported by the entry point mod.d.ts
// Warning: (ae-forgotten-export) The symbol "RemoveViewChange" needs to be exported by the entry point mod.d.ts
// Warning: (ae-forgotten-export) The symbol "ChildViewChange" needs to be exported by the entry point mod.d.ts
// Warning: (ae-forgotten-export) The symbol "EditViewChange" needs to be exported by the entry point mod.d.ts
//
// @public
export type ViewChange = AddViewChange | RemoveViewChange | ChildViewChange | EditViewChange;

// @public (undocumented)
export type ViewFactory<TSchema extends Schema, TTable extends keyof TSchema['tables'] & string, TReturn, T> = (query: Query<TSchema, TTable, TReturn>, input: Input, format: Format, onDestroy: () => void, onTransactionCommit: (cb: () => void) => void, queryComplete: true | Promise<true>, updateTTL: (ttl: TTL) => void) => T;

// @public (undocumented)
export class Zero<const S extends Schema, MD extends CustomMutatorDefs | undefined = undefined> {
    constructor(options: ZeroOptions<S, MD>);
    // (undocumented)
    get clientGroupID(): Promise<ClientGroupID>;
    get clientID(): ClientID;
    close(): Promise<void>;
    get closed(): boolean;
    get idbName(): string;
    inspect(): Promise<Inspector>;
    // Warning: (ae-forgotten-export) The symbol "DeepMerge" needs to be exported by the entry point mod.d.ts
    readonly mutate: MD extends CustomMutatorDefs ? DeepMerge<DBMutator<S>, MakeCustomMutatorInterfaces<S, MD>> : DBMutator<S>;
    readonly mutateBatch: BatchMutator<S>;
    get online(): boolean;
    onOnline: (listener: (online: boolean) => void) => (() => void);
    // (undocumented)
    preload(query: Query<S, keyof S['tables'] & string, any>, options?: PreloadOptions | undefined): {
        cleanup: () => void;
        complete: Promise<void>;
    };
    // (undocumented)
    readonly query: MakeEntityQueriesFromSchema<S>;
    // (undocumented)
    readonly queryDelegate: QueryDelegate;
    get schemaVersion(): string;
    // Warning: (ae-forgotten-export) The symbol "HTTPString" needs to be exported by the entry point mod.d.ts
    get server(): HTTPString | null;
    // (undocumented)
    readonly storageKey: string;
    // (undocumented)
    readonly userID: string;
    // (undocumented)
    readonly version: string;
}

// @public
export interface ZeroOptions<S extends Schema, MD extends CustomMutatorDefs | undefined = undefined> {
    auth?: string | ((error?: 'invalid-token') => MaybePromise<string | undefined>) | undefined;
    batchViewUpdates?: ((applyViewUpdates: () => void) => void) | undefined;
    hiddenTabDisconnectDelay?: number | undefined;
    // Warning: (ae-forgotten-export) The symbol "StoreProvider" needs to be exported by the entry point mod.d.ts
    kvStore?: 'mem' | 'idb' | StoreProvider | undefined;
    logLevel?: LogLevel | undefined;
    maxHeaderLength?: number | undefined;
    // @deprecated
    maxRecentQueries?: number | undefined;
    // (undocumented)
    mutate?: UserMutateParams;
    mutators?: MD | undefined;
    onClientStateNotFound?: (() => void) | undefined;
    onError?: OnError | undefined;
    // @deprecated
    onOnlineChange?: ((online: boolean) => void) | undefined;
    onUpdateNeeded?: ((reason: UpdateNeededReason) => void) | undefined;
    // Warning: (ae-forgotten-export) The symbol "UserMutateParams" needs to be exported by the entry point mod.d.ts
    push?: UserMutateParams;
    // Warning: (ae-forgotten-export) The symbol "UserQueryParams" needs to be exported by the entry point mod.d.ts
    //
    // (undocumented)
    query?: UserQueryParams;
    queryChangeThrottleMs?: number | undefined;
    schema: S;
    server?: string | null | undefined;
    slowMaterializeThreshold?: number | undefined;
    storageKey?: string | undefined;
    userID: string;
}

// Warnings were encountered during analysis:
//
// /Users/mlaw/workspace/mono/packages/zero-client/src/client/custom.ts:47:3 - (ae-forgotten-export) The symbol "MutationOk" needs to be exported by the entry point mod.d.ts
// /Users/mlaw/workspace/mono/packages/zero-protocol/src/ast.ts:191:3 - (ae-forgotten-export) The symbol "Row_2" needs to be exported by the entry point mod.d.ts
// /Users/mlaw/workspace/mono/packages/zero-protocol/src/ast.ts:246:3 - (ae-forgotten-export) The symbol "Correlation" needs to be exported by the entry point mod.d.ts
// /Users/mlaw/workspace/mono/packages/zero-protocol/src/ast.ts:248:3 - (ae-forgotten-export) The symbol "System" needs to be exported by the entry point mod.d.ts
// /Users/mlaw/workspace/mono/packages/zero-schema/src/builder/relationship-builder.ts:44:5 - (ae-forgotten-export) The symbol "PreviousSchema" needs to be exported by the entry point mod.d.ts
// /Users/mlaw/workspace/mono/packages/zero-schema/src/builder/relationship-builder.ts:44:5 - (ae-forgotten-export) The symbol "ConnectArg" needs to be exported by the entry point mod.d.ts
// /Users/mlaw/workspace/mono/packages/zero-schema/src/builder/relationship-builder.ts:44:5 - (ae-forgotten-export) The symbol "ManyConnection" needs to be exported by the entry point mod.d.ts
// /Users/mlaw/workspace/mono/packages/zero-schema/src/builder/relationship-builder.ts:72:5 - (ae-forgotten-export) The symbol "OneConnection" needs to be exported by the entry point mod.d.ts
// /Users/mlaw/workspace/mono/packages/zero-schema/src/builder/schema-builder.ts:18:28 - (ae-forgotten-export) The symbol "RelationshipsSchema" needs to be exported by the entry point mod.d.ts
// /Users/mlaw/workspace/mono/packages/zero-schema/src/builder/table-builder.ts:6:56 - (ae-forgotten-export) The symbol "PrimaryKey" needs to be exported by the entry point mod.d.ts
// /Users/mlaw/workspace/mono/packages/zql/src/ivm/view.ts:9:22 - (ae-forgotten-export) The symbol "Value" needs to be exported by the entry point mod.d.ts
// /Users/mlaw/workspace/mono/packages/zql/src/query/typed-view.ts:14:3 - (ae-forgotten-export) The symbol "Listener" needs to be exported by the entry point mod.d.ts

// (No @packageDocumentation comment for this package)

```
